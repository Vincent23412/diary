<!doctype html>
<html lang="zh-Hant-TW">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>2025-07-27</title>
  <link rel="stylesheet" href="/notes/style.css" />
</head>
<body>
  <header class="container py-24">
    <h1 class="title">2025-07-27</h1>
    <nav class="nav">
      <a href="/notes/daily-notes/index.html" class="nav-link">← 回分類</a>
      <a href="/notes/index.html" class="nav-link">回總覽</a>
    </nav>
  </header>

  <main class="container card">
    <article class="post-content">
      <p>你這題答對得非常好！這是一題典型的 AWS Hybrid Cloud + Storage Gateway + Lifecycle Policy 題型，以下幫你整理重點邏輯，方便之後複習或應用到相似情境：</p>
<p>✅ 正確選項：</p>
<p>Launch a new file gateway that connects to your on-premises data center using AWS Storage Gateway. Upload the documents to the file gateway and set up a lifecycle policy to move the data into Glacier for data archival.</p>
<p>🎯 題目需求拆解：</p>
<p>🔍 為什麼是 File Gateway？</p>
<p>❌ 其他選項為何不行？</p>
<p>🔸 Tape Gateway</p>
<ul>
<li>
<p>雖支援 Glacier 備份，但是虛擬磁帶形式，不支援 SMB 或快速檔案存取</p>
</li>
<li>
<p>無本地快取機制，不利低延遲需求</p>
</li>
<li>
<p>檔案恢復通常需數小時甚至數天</p>
</li>
</ul>
<p>🔸 EBS + Direct Connect</p>
<ul>
<li>
<p>EBS 為區塊儲存，不支援 SMB 協定存取</p>
</li>
<li>
<p>將 EBS snapshot 搬至 S3 + Glacier 雖可達儲存需求，但流程繁複且成本高</p>
</li>
<li>
<p>無本地快取，不利低延遲讀取</p>
</li>
</ul>
<p>🔸 AWS DataSync</p>
<ul>
<li>
<p>適合一次性大量資料遷移</p>
</li>
<li>
<p>不提供本地快取機制</p>
</li>
<li>
<p>無法做到 SMB 協定存取，僅支援 Linux NFS/NAS 資料遷移</p>
</li>
</ul>
<p>🧠 小結：</p>
<p>如果你未來遇到以下關鍵詞：「混合雲、SMB 存取、本地快取、S3 備份、Glacier 歸檔」，就可以直覺聯想 File Gateway。有需要我也可以幫你畫一張簡單的架構圖來輔助理解！</p>
<p>這題你答對得非常好！這裡幫你統整「CloudWatch 內建 vs 自訂指標」的重點，讓你在考場或實務上都能快速分辨哪些指標是「需要額外安裝或設定的 custom metrics」。</p>
<p>✅ 正確答案：</p>
<p>Memory Utilization of an EC2 instance</p>
<p>🔍 預設 CloudWatch EC2 Metrics（不需自訂）：</p>
<p>CloudWatch 預設會自動提供下列指標（每 5 分鐘一次，開啟詳細監控後為 1 分鐘）：</p>
<p>❌ 無法透過預設 CloudWatch 取得（需自訂）：</p>
<p>以下這些指標屬於作業系統層級，不屬於 EC2 hypervisor 層面，所以 AWS 不會自動收集，需透過 CloudWatch Agent 或 CloudWatch Scripts 自行上傳：</p>
<p>🧠 小技巧：一眼分辨是否需要自訂</p>
<p>凡是牽涉到「RAM、磁碟容量（非 IOPS）、系統內部的空間使用情況」幾乎都是需要安裝 CloudWatch Agent 才能收集的指標。</p>
<p>📦 如何設定自訂 Memory Utilization？</p>
<p>你可以透過以下兩種方式：</p>
<p>安裝 CloudWatch Agent</p>
<p>CloudWatch Monitoring Scripts (舊方法)</p>
<p>如果你之後在考題或架構設計中看到關於：</p>
<ul>
<li>
<p>監控記憶體</p>
</li>
<li>
<p>磁碟空間</p>
</li>
<li>
<p>Swap 或 PageFile
這類需求時，關鍵字是 CloudWatch Agent 與 Custom Metrics！</p>
</li>
</ul>
<p>有需要我可以幫你補一份 CloudWatch Agent 安裝與設定的教學 👇</p>
<p>你這題又答對了，很不錯！這是一道典型針對 Amazon EKS 安全性強化 的考題，重點在於「etcd 的加密」。我們來快速整理一下觀念：</p>
<p>✅ 正確選項：</p>
<p>Enable secret encryption with a new AWS KMS key on an existing Amazon EKS cluster to encrypt sensitive data stored in the EKS cluster’s etcd key-value store.</p>
<p>🎯 題目重點解析：</p>
<p>🔐 解法關鍵知識：</p>
<p>🔹 etcd 是什麼？</p>
<ul>
<li>
<p>Kubernetes 的關鍵元件</p>
</li>
<li>
<p>是一個 key-value 資料庫，儲存整個叢集的設定狀態，包括 Secrets、ConfigMaps 等敏感資料</p>
</li>
</ul>
<p>🔹 預設情況下，etcd 中的 secrets 是</p>
<p>明文儲存</p>
<ul>
<li>意即：有權限存取 etcd 的人就能看到機密資料的原文</li>
</ul>
<p>🔹 要保護它的唯一標準方法是：</p>
<p>➤ 啟用 Kubernetes Secret Encryption with AWS KMS</p>
<p>這個動作會：</p>
<ul>
<li>
<p>使用自定義的 KMS key</p>
</li>
<li>
<p>讓 K8s 在寫入 etcd 前先加密 secrets</p>
</li>
</ul>
<p>❌ 其他選項錯在哪？</p>
<p>📌 小結：如何在 Amazon EKS 加密 Secrets？</p>
<p>建立一個 AWS KMS key（建議使用 Customer Managed Key）</p>
<p>建立或更新 EKS 叢集，啟用 secret encryption（可用 eksctl）</p>
<p>確保新的 secrets 自動被加密並儲存於 etcd 中</p>
<p>如果你之後在考題中看到這些 keyword：</p>
<ul>
<li>
<p>“etcd”</p>
</li>
<li>
<p>“secrets”</p>
</li>
<li>
<p>“sensitive configuration”</p>
</li>
<li>
<p>“KMS”</p>
</li>
<li>
<p>“encrypt at rest”</p>
</li>
</ul>
<p>那正確答案幾乎一定是：EKS Secret Encryption using KMS</p>
<p>需要我幫你示範怎麼用 eksctl 或 AWS CLI 來開啟 secret encryption 的話，也可以說一聲，我可以給你指令 ✅</p>
<p>你這題答得非常好！這是考 企業身份整合（Enterprise Identity Federation）+ S3 存取控管 的典型設計題目。下面幫你整理考點與實作重點，讓你理解更扎實：</p>
<p>✅ 正確答案：</p>
<p>Set up a Federation proxy or an Identity provider, and use AWS Security Token Service (STS) to generate temporary tokens.</p>
<p>Configure an IAM role and an IAM Policy to access the bucket.</p>
<p>🎯 題目重點需求：</p>
<p>🔐 解法重點：</p>
<p>✅ 1. 使用 AWS STS + Identity Provider + Federation</p>
<ul>
<li>
<p>用公司內部的 AD 或 LDAP 做 SAML 2.0 聯邦登入</p>
</li>
<li>
<p>搭配 AWS STS 發 temporary credentials（不需建立 IAM user）</p>
</li>
<li>
<p>可搭配 AD FS、Okta、JumpCloud 等工具建立 SAML assertion</p>
</li>
</ul>
<p>✅ 2. 設定 IAM Role + Policy 控制資料夾存取</p>
<ul>
<li>
<p>建立一個 IAM Role 給所有員工共用（由 Identity Provider 授權切換）</p>
</li>
<li>
<p>IAM Policy 使用變數，例如：</p>
</li>
</ul>
<p>"Resource": "arn:aws:s3:::your-bucket-name/home/${aws:username}/*"</p>
<ul>
<li>這樣每個人登入後只能看到自己對應的資料夾（例如 /home/alice/）</li>
</ul>
<p>❌ 錯誤選項解析：</p>
    </article>
    <p class="post-meta">
      原文：
      <a href="https://github.com/Vincent23412/diary/blob/main/content/daily-notes/2025-07-27.md" target="_blank">GitHub</a> ·
      <a href="https://raw.githubusercontent.com/Vincent23412/diary/main/content/daily-notes/2025-07-27.md" target="_blank">raw</a>
    </p>
  </main>

  <footer class="container py-24">
    <small>最後更新：2025-11-04</small>
  </footer>
</body>
</html>

# ğŸ› ï¸ TypeScript é–‹ç™¼éç¨‹å•é¡Œæ•´ç†ç­†è¨˜

## 1. âŒ ERR_UNKNOWN_FILE_EXTENSION: ".ts"

### å•é¡Œæè¿°

ä½¿ç”¨ Node.js åŸ·è¡Œ .ts æª”æ¡ˆæœƒå‡ºç¾éŒ¯èª¤ï¼š

TypeError [ERR_UNKNOWN_FILE_EXTENSION]: Unknown file extension ".ts"


### åŸå› 

Node.js ä¸æ”¯æ´ç›´æ¥åŸ·è¡Œ TypeScript (.ts) æª”æ¡ˆã€‚

### è§£æ³•

### âœ… æ–¹æ³•ä¸€ï¼šä½¿ç”¨ ts-node

yarn add -D ts-node typescript
npx ts-node src/index.ts


### âœ… æ–¹æ³•äºŒï¼šä½¿ç”¨ tsxï¼ˆæ¨è–¦ï¼‰

yarn add -D tsx typescript
npx tsx src/index.ts


### âœ… æ–¹æ³•ä¸‰ï¼šå…ˆç·¨è­¯å†åŸ·è¡Œ

npx tsc     # ç·¨è­¯ ts -> js
node dist/index.js


## 2. âŒ éŒ¯èª¤çš„ yarn å®‰è£æŒ‡ä»¤

### éŒ¯èª¤æŒ‡ä»¤

yarn -i --save-dev @types/express


### æ­£ç¢ºç”¨æ³•

yarn add -D @types/express


## 3. â“ æ˜¯å¦å¯ä»¥ä½¿ç”¨ .tsx ä½œç‚ºåŸ·è¡Œå·¥å…·ï¼Ÿ

### å›ç­”

âœ… æ˜¯çš„ï¼Œé€™è£¡çš„ tsx æ˜¯æŒ‡ä¸€å€‹å¿«é€ŸåŸ·è¡Œ TypeScript çš„å·¥å…·ï¼ˆesbuild-kit/tsxï¼‰ï¼Œå®ƒæ”¯æ´ .ts å’Œ .tsx åŸ·è¡Œï¼Œä¸”æ•ˆèƒ½æ¯” ts-node æ›´å¥½ã€‚

### å®‰è£èˆ‡ä½¿ç”¨

yarn add -D tsx
npx tsx src/index.ts


## 4. âœ… ä½¿ç”¨ nodemon æ­é… TypeScript

### å®‰è£æ–¹å¼

yarn add -D nodemon tsx typescript


### å»ºç«‹ nodemon.json

{
  "watch": ["src"],
  "ext": "ts",
  "exec": "tsx src/index.ts"
}


### package.json script

"scripts": {
  "dev": "nodemon"
}


### åŸ·è¡Œæ–¹å¼

yarn dev


# ğŸ§  TypeScript å¥—ä»¶å‹åˆ¥ç­†è¨˜ï¼ˆ@typesï¼‰

## âœ… ç‚ºä»€éº¼éœ€è¦å‹åˆ¥å®šç¾©ï¼Ÿ

- TypeScript æ˜¯éœæ…‹å‹åˆ¥èªè¨€ï¼Œéœ€è¦çŸ¥é“æ¯å€‹å‡½å¼èˆ‡ç‰©ä»¶çš„ã€Œå‹åˆ¥ã€æ‰èƒ½æ­£ç¢ºç·¨è­¯ã€‚

- æœ‰äº› JavaScript å¥—ä»¶ï¼ˆå¦‚ expressã€wsï¼‰æ²’æœ‰å…§å»ºå‹åˆ¥è³‡è¨Šï¼Œæ‰€ä»¥ TypeScript éœ€è¦é¡å¤–çš„å‹åˆ¥å®šç¾©æª”æ¡ˆä¾†ç†è§£å®ƒå€‘ã€‚

## ğŸ” å¦‚ä½•åˆ¤æ–·ä¸€å€‹å¥—ä»¶æ˜¯å¦éœ€è¦å®‰è£ @types/xxxï¼Ÿ

### âœ… ä¸éœ€è¦å®‰è£ï¼ˆå…§å»ºå‹åˆ¥ï¼‰

é€™äº›å¥—ä»¶æœ¬èº«å°±æ”¯æ´ TypeScriptï¼Œå®‰è£ä¸»å¥—ä»¶å³å¯ã€‚

- åˆ¤æ–·æ–¹æ³•ï¼š

### ç¯„ä¾‹ï¼š

yarn add axios         # âœ… ä¸éœ€è¦ @types/axios
yarn add dayjs         # âœ… ä¸éœ€è¦ @types/dayjs


### âŒ éœ€è¦å®‰è£ @types/xxx

é€™äº›æ˜¯ JavaScript å¥—ä»¶ï¼Œæ²’æœ‰å‹åˆ¥æè¿°ï¼Œè¦é€éç¤¾ç¾¤æä¾›çš„ DefinitelyTyped å®‰è£å‹åˆ¥ã€‚

- å®‰è£æ–¹å¼ï¼š

yarn add lodash
yarn add -D @types/lodash


- D ä»£è¡¨é–‹ç™¼éšæ®µä½¿ç”¨ï¼ˆdevDependenciesï¼‰

### å¸¸è¦‹ç¯„ä¾‹ï¼š

## ğŸ›  å¿«é€Ÿåˆ¤æ–·æ–¹å¼

### æ–¹æ³•ä¸€ï¼šç”¨ yarn æŸ¥å‹åˆ¥æ”¯æ´

yarn info axios types       # âœ… æœ‰å‹åˆ¥ => ä¸éœ€é¡å¤–å®‰è£
yarn info express types     # âŒ ç„¡å‹åˆ¥ => éœ€è¦ @types/express


### æ–¹æ³•äºŒï¼šæŸ¥ npm é é¢èªªæ˜

- æœå°‹é—œéµå­— typescript support æˆ– types

- çœ‹æ˜¯å¦æåˆ°å‹åˆ¥å…§å»ºã€é‚„æ˜¯éœ€è¦å¦å¤–å®‰è£

## ğŸ§¾ å°æé†’

- å‹åˆ¥å®šç¾©åªåœ¨ é–‹ç™¼éšæ®µä½¿ç”¨ï¼Œæ‰€ä»¥æ‡‰æ”¾åœ¨ devDependencies

- å¦‚æœä½ éƒ¨ç½²å¾Œé‚„æœƒç”¨ ts-node ç›´æ¥åŸ·è¡Œ .ts æª”ï¼Œé€™æ™‚ @types/xxx å¯èƒ½éœ€è¦é€² dependencies

# ğŸ§  TypeScript / Node.js é–‹ç™¼ç­†è¨˜ï¼šPort è¢«ä½”ç”¨ & app vs server å·®ç•°

## ğŸ”§ ä¸€ã€ç•¶ Port è¢«ä½”ç”¨æ™‚æ€éº¼è¾¦ï¼Ÿ

### âœ… å•é¡Œæè¿°ï¼š

ç•¶ä½ å•Ÿå‹•ä¼ºæœå™¨æ™‚å‡ºç¾éŒ¯èª¤ï¼š

Error: listen EADDRINUSE: address already in use 127.0.0.1:3000


è¡¨ç¤º 3000 port å·²è¢«å…¶ä»–ç¨‹å¼ä½”ç”¨ã€‚

### âœ… è§£æ³•æ­¥é©Ÿï¼š

### 1ï¸âƒ£ æŸ¥å‡ºæ˜¯èª°ä½”ç”¨äº†è©² port

### Windowsï¼š

netstat -ano | findstr :3000


æœƒçœ‹åˆ°ä¸€è¡Œé¡ä¼¼é€™æ¨£çš„çµæœï¼Œæœ€å¾Œçš„æ•¸å­—æ˜¯ PIDï¼š

TCP    127.0.0.1:3000     0.0.0.0:0     LISTENING     12345


### macOS / Linuxï¼š

lsof -i :3000


### 2ï¸âƒ£ çµ‚æ­¢è©²ç¨‹å¼ï¼ˆä½¿ç”¨ PIDï¼‰

### Windowsï¼š

taskkill /PID 12345 /F


### macOS / Linuxï¼š

kill -9 12345


### 3ï¸âƒ£ æˆ–æ”¹ç”¨å…¶ä»– portï¼ˆé–‹ç™¼ä¸­å»ºè­°ï¼‰

const PORT = process.env.PORT || 3001;
server.listen(PORT);


å•Ÿå‹•æ™‚æ”¹ç”¨ä¸åŒ portï¼š

PORT=3001 yarn dev


## ğŸš¦ äºŒã€Express ä¸­ app å’Œ server çš„å·®ç•°

### âœ… app æ˜¯ä»€éº¼ï¼Ÿ

- app = express();
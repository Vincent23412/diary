<!doctype html>
<html lang="zh-Hant-TW">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>2025-06-22</title>
  <link rel="stylesheet" href="/notes/style.css" />
</head>
<body>
  <header class="container py-24">
    <h1 class="title">2025-06-22</h1>
    <nav class="nav">
      <a href="/notes/daily-notes/index.html" class="nav-link">â† å›åˆ†é¡</a>
      <a href="/notes/index.html" class="nav-link">å›ç¸½è¦½</a>
    </nav>
  </header>

  <main class="container card">
    <article class="post-content">
      <p>ğŸ¢ AWS Organizationsï¼šè®“ R&amp;D éƒ¨é–€è„«é›¢æ¯ä¼æ¥­å»ºç«‹æ–°çµ„ç¹”çš„æ­£ç¢ºé·ç§»æ–¹å¼</p>
<p>ğŸ“Œ é¡Œç›®é‡é»</p>
<ul>
<li>
<p>å…¬å¸ç›®å‰åœ¨ AWS Organizations ä¸­æœ‰ 5 å€‹ OU</p>
</li>
<li>
<p>R&amp;D å–®ä½å³å°‡ç¨ç«‹ï¼Œéœ€æ“æœ‰è‡ªå·±çš„æ–° AWS Organization</p>
</li>
<li>
<p>å·²ç‚º R&amp;D å»ºç«‹æ–°çš„ ç®¡ç†å¸³è™Ÿï¼ˆmanagement accountï¼‰</p>
</li>
</ul>
<p>âœ… æ­£ç¢ºç­”æ¡ˆ</p>
<p>B. Invite the R&amp;D AWS account to be part of the new organization after the R&amp;D AWS account has left the prior organization</p>
<p>ğŸ” é¸é …è§£æ</p>
<p>ğŸ§­ æ­£ç¢ºæµç¨‹è£œå……èªªæ˜</p>
<p>è¦è®“æŸå€‹ AWS å¸³è™Ÿå¾ A çµ„ç¹”é·ç§»åˆ° B çµ„ç¹”ï¼Œæ‡‰éµå¾ªä»¥ä¸‹æ­¥é©Ÿï¼š</p>
<p>å¾åŸçµ„ç¹”ç§»é™¤å¸³è™Ÿ</p>
<p>å¾æ–°çµ„ç¹”çš„ç®¡ç†å¸³è™Ÿç™¼å‡ºé‚€è«‹</p>
<p>åœ¨ R&amp;D å¸³è™Ÿä¸­æ¥å—é‚€è«‹</p>
<p>âœ… çµè«–</p>
<p>é¸é … B ç¬¦åˆ AWS Organizations çš„è¨­è¨ˆèˆ‡é™åˆ¶ï¼Œä¸”æ˜¯æœ€ç°¡å–®ã€åˆæ³•ä¸”ä½é¢¨éšªçš„é·ç§»æ–¹å¼ã€‚</p>
<p>ğŸ§± [CloudFormation &amp; IAM] EC2 å®‰å…¨å­˜å– DynamoDB çš„æœ€ä½³æ–¹å¼</p>
<p>ğŸ“Œ é¡Œç›®èƒŒæ™¯</p>
<ul>
<li>
<p>ä½¿ç”¨ CloudFormation å»ºç«‹ä¸‰å±¤å¼æ‡‰ç”¨ï¼ˆWeb Tier / App Tier / DynamoDBï¼‰</p>
</li>
<li>
<p>Web/App Tier éƒ¨ç½²åœ¨ EC2 ä¸Š</p>
</li>
<li>
<p>DynamoDB å±¤ä¸å¯å…¬é–‹å­˜å–</p>
</li>
<li>
<p>è¦è®“ EC2 è®€å¯« DynamoDBï¼Œä½† ä¸èƒ½æš´éœ² API é‡‘é‘°</p>
</li>
</ul>
<p>âœ… æ­£ç¢ºç­”æ¡ˆï¼š</p>
<p>B. Create an IAM role that has the required permissions to read and write from the DynamoDB tables. Add the role to the EC2 instance profile, and associate the instance profile with the application instances</p>
<p>ğŸ§  è©³ç´°è§£æ</p>
<p>ğŸ çµè«–</p>
<p>é¸é … B ç¬¦åˆæœ€ä½³å¯¦è¸ï¼šEC2 ä½¿ç”¨ IAM Role æ­é… Instance Profile ä¾†å®‰å…¨å­˜å– DynamoDBï¼Œä¸éœ€ç®¡ç†é‡‘é‘°ï¼Œä¹Ÿé¿å…è³‡è¨Šå¤–æ´©é¢¨éšªã€‚</p>
<p>ğŸ“¦ [S3 Access Control] å¤šå€‹ Vendor å­˜å– S3 Bucket éœ€æœ€å°æ¬Šé™è¨­è¨ˆ</p>
<p>ğŸ“Œ é¡Œç›®éœ€æ±‚</p>
<ul>
<li>
<p>æœ‰å¤šå€‹ vendor AWS å¸³è™Ÿè¦ä¸‹è¼‰å…¬å¸å­˜åœ¨ S3 çš„ç‰©ä»¶</p>
</li>
<li>
<p>å…¬å¸å¸Œæœ›é€™äº›å¸³è™Ÿæ“æœ‰æœ€å°å¿…è¦æ¬Šé™ï¼ˆminimum accessï¼‰</p>
</li>
<li>
<p>è¦æœ‰æœ€ä½æ“ä½œè² æ“”ï¼ˆleast operational overheadï¼‰</p>
</li>
</ul>
<p>âœ… æ­£ç¢ºç­”æ¡ˆï¼š</p>
<p>C. Create a cross-account IAM role that has a read-only access policy specified for the IAM role</p>
<p>ğŸ§  è©³ç´°è§£æ</p>
<p>ğŸ›  Cross-Account IAM Role æ¶æ§‹</p>
<p>Vendor AWS Account</p>
<p>â†“ assume role</p>
<p>Company AWS Account (S3 bucket æ‰€åœ¨)</p>
<p>â†³ IAM Role (with S3 read-only policy)</p>
<p>â†³ S3 Bucket (with trust policy allowing assumeRole)</p>
<p>â˜‘ æ­¥é©Ÿæ¦‚è¦ï¼š</p>
<p>å…¬å¸ç«¯å»ºç«‹ IAM Role</p>
<p>Vendor ä½¿ç”¨ STS AssumeRole å­˜å–è³‡æº</p>
<p>ğŸ çµè«–</p>
<p>é¸é … C æ˜¯æœ€ä½³å¯¦å‹™åšæ³•ï¼Œç¬¦åˆä»¥ä¸‹æ¢ä»¶ï¼š</p>
<ul>
<li>
<p>å®‰å…¨æ€§é«˜ï¼šåªå…è¨±æŒ‡å®š vendor assume role</p>
</li>
<li>
<p>æœ€å°æ¬Šé™ï¼šåªçµ¦ GetObject</p>
</li>
<li>
<p>æ“ä½œè² æ“”ä½ï¼šé›†ä¸­ç®¡ç†è§’è‰²èˆ‡æ”¿ç­–å³å¯</p>
</li>
</ul>
<p>â˜ï¸ [EC2 DR Strategy] åœ¨ Failover å€åŸŸä¸­ç¢ºä¿ EC2 å®¹é‡çš„ç½é›£å¾©åŸç­–ç•¥</p>
<p>ğŸ“Œ é¡Œç›®éœ€æ±‚</p>
<ul>
<li>
<p>è¨­è¨ˆ Disaster Recoveryï¼ˆDRï¼‰ç­–ç•¥</p>
</li>
<li>
<p>è¦åœ¨ Failover AWS Region ä¸­ç¢ºä¿æœ‰è¶³å¤ çš„ EC2 å®¹é‡</p>
</li>
<li>
<p>å¿…é ˆä¿è­‰å®¹é‡ï¼ˆmust meet capacityï¼‰</p>
</li>
</ul>
<p>âœ… æ­£ç¢ºç­”æ¡ˆï¼š</p>
<p>D. Purchase a Capacity Reservation in the failover Region</p>
<p>ğŸ§  è©³ç´°è§£æ</p>
<p>ğŸ§¾ Capacity Reservation æ˜¯ä»€éº¼ï¼Ÿ</p>
<ul>
<li>
<p>é å…ˆä¿ç•™ EC2 å¯¦é«”å®¹é‡</p>
</li>
<li>
<p>å¯èˆ‡ On-Demand / RI / Savings Plan ä¸¦ç”¨</p>
</li>
<li>
<p>é¿å… failover æ™‚é«˜å³°æœŸå•Ÿå‹•å¤±æ•—</p>
</li>
</ul>
<p>ğŸ” é—œéµç‰¹æ€§ï¼š</p>
<ul>
<li>
<p>ä¿ç•™æŒ‡å®š AZã€instance type çš„ å¯¦é«”è³‡æº</p>
</li>
<li>
<p>ç¢ºä¿éœ€è¦æ™‚å¯ä»¥ç«‹å³å•Ÿå‹• EC2 å¯¦ä¾‹</p>
</li>
<li>
<p>é©åˆç”¨æ–¼ç½é›£å¾©åŸã€HPC ç­‰å ´æ™¯</p>
</li>
</ul>
<p>ğŸ çµè«–</p>
<p>è‹¥ä¼æ¥­è¦æ±‚ failover region ä¸€å®šè¦æœ‰å¯ç”¨çš„ EC2 è³‡æºï¼Œå‰‡ï¼š</p>
<ul>
<li>
<p>åªæœ‰ Capacity Reservation èƒ½ä¿è­‰å®¹é‡å¯ç”¨</p>
</li>
<li>
<p>æ˜¯è¨­è¨ˆç½é›£å¾©åŸç­–ç•¥çš„ å”¯ä¸€æ­£ç¢ºé¸æ“‡</p>
</li>
</ul>
<p>âœ… é¸é … D æ˜¯æ­£ç¢ºç­”æ¡ˆã€‚</p>
<p>â˜ï¸ [S3 Global Secure Sharing] å…¬å¸å…¨çƒå“¡å·¥è³‡æ–™æ”¶é›†èˆ‡åˆ†äº«çš„å®‰å…¨è§£æ³•</p>
<p>ğŸ“Œ é¡Œç›®éœ€æ±‚</p>
<ul>
<li>
<p>å…¬å¸éœ€å°‡ç ”ç©¶è³‡æ–™æ”¶é›†ä¸¦å­˜è‡³ Amazon S3</p>
</li>
<li>
<p>å…¨çƒå“¡å·¥å¯å®‰å…¨å­˜å–è³‡æ–™</p>
</li>
<li>
<p>è§£æ³•å¿…é ˆæ˜¯å®‰å…¨ã€ä½æ“ä½œè² æ“”ï¼ˆminimal operational overheadï¼‰</p>
</li>
</ul>
<p>âœ… æ­£ç¢ºç­”æ¡ˆï¼š</p>
<p>A. Use an AWS Lambda function to create an S3 presigned URL. Instruct employees to use the URL</p>
<p>ğŸ§  è©³ç´°è§£æ</p>
<p>ğŸ§¾ ç‚ºä½•é¸ Aï¼Ÿ</p>
<p>ğŸ” S3 Presigned URL å„ªé»ï¼š</p>
<ul>
<li>
<p>æ™‚æ•ˆæ€§ï¼šå¯è¨­å®šéæœŸæ™‚é–“</p>
</li>
<li>
<p>æœ€å°æ¬Šé™ï¼šåƒ…é™ç‰¹å®šç‰©ä»¶ã€æ“ä½œï¼ˆå¦‚ä¸Šå‚³ã€ä¸‹è¼‰ï¼‰</p>
</li>
<li>
<p>ä½ç¶­é‹ï¼šç„¡éœ€å»º IAM å¸³è™Ÿèˆ‡å¯†ç¢¼</p>
</li>
<li>
<p>é©åˆå…¨çƒç”¨æˆ¶ï¼šé€é HTTPS å­˜å–å³å¯ï¼Œä¸å—å¹³å°é™åˆ¶</p>
</li>
</ul>
<p>âš™ï¸ Lambda å¯¦ä½œæ–¹å¼ï¼š</p>
<ul>
<li>
<p>ä½¿ç”¨ IAM è§’è‰²çµ¦ Lambda å­˜å– S3 æ¬Šé™</p>
</li>
<li>
<p>ä¾éœ€æ±‚ç”¢ç”Ÿ getObject æˆ– putObject çš„é ç°½ç¶²å€</p>
</li>
<li>
<p>é€éå‰ç«¯ç³»çµ±æˆ– API å‚³é€ URL çµ¦ç”¨æˆ¶</p>
</li>
</ul>
<p>ğŸ çµè«–</p>
<p>è‹¥å…¬å¸æƒ³ç”¨æœ€ä½ç¶­é‹æˆæœ¬ã€é«˜å®‰å…¨æ€§æ–¹å¼å°‡ S3 è³‡æ–™åˆ†äº«çµ¦å…¨çƒå“¡å·¥ï¼š</p>
<ul>
<li>S3 Presigned URL + Lambda è‡ªå‹•ç”¢ç”Ÿ æ˜¯æœ€ä½³é¸æ“‡</li>
</ul>
<p>âœ… é¸é … A ç‚ºæ­£ç¢ºç­”æ¡ˆã€‚</p>
    </article>
    <p class="post-meta">
      åŸæ–‡ï¼š
      <a href="https://github.com/Vincent23412/diary/blob/main/content/daily-notes/2025-06-22.md" target="_blank">GitHub</a> Â·
      <a href="https://raw.githubusercontent.com/Vincent23412/diary/main/content/daily-notes/2025-06-22.md" target="_blank">raw</a>
    </p>
  </main>

  <footer class="container py-24">
    <small>æœ€å¾Œæ›´æ–°ï¼š2025-12-19</small>
  </footer>
</body>
</html>
